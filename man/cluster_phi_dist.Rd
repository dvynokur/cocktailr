% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_phi_dist.R
\name{cluster_phi_dist}
\alias{cluster_phi_dist}
\title{Distance between Cocktail clusters based on direct co-membership phi}
\usage{
cluster_phi_dist(x, clusters = NULL)
}
\arguments{
\item{x}{A \code{"cocktail"} object from \code{\link{cocktail_cluster}},
containing at least \code{Plot.cluster} and \code{Cluster.species}.}

\item{clusters}{Optional cluster identifiers (internal nodes) to be compared.
Can be numeric node IDs (e.g. \code{c(12, 27)}) or character labels
(e.g. \code{c("c_12","c_27")}).
If \code{NULL} or missing, all internal nodes
\code{1:nrow(x$Cluster.species)} are used.}
}
\value{
A \code{\link[stats]{dist}} object with distances \eqn{d = 1-\phi}
between clusters.
}
\description{
Computes pairwise distances between Cocktail clusters (internal nodes) by
computing the \eqn{\phi} coefficient between their binary plot-membership
vectors across all plots.

Cluster membership is derived from \code{x$Plot.cluster} as:
\code{membership = (Plot.cluster > 0)}. This works for both
\code{plot_values = "binary"} and \code{plot_values = "rel_cover"}, because
in both cases the stored values are positive for plots meeting the Cocktail
membership threshold (m-threshold) of a node.

For clusters \eqn{A} and \eqn{B}, similarity is:
\deqn{\mathrm{sim}(A,B) = \phi(A,B) \in [-1,1],}
where \eqn{\phi(A,B)} is computed from the 2×2 contingency table of plot
co-membership (plots in \eqn{A} vs. plots in \eqn{B}).

The distance is defined as:
\deqn{d(A,B) = 1 - \phi(A,B).}

Since \eqn{\phi \in [-1,1]}, distances lie in \eqn{[0,2]}.
}
\details{
Let \eqn{g_A} and \eqn{g_B} be the binary membership vectors (length = number
of plots) for clusters \eqn{A} and \eqn{B}. The \eqn{\phi} coefficient is
computed from the 2×2 table:
\itemize{
\item \eqn{a}: plots where \eqn{g_A=1} and \eqn{g_B=1},
\item \eqn{b}: plots where \eqn{g_A=1} and \eqn{g_B=0},
\item \eqn{c}: plots where \eqn{g_A=0} and \eqn{g_B=1},
\item \eqn{d}: plots where \eqn{g_A=0} and \eqn{g_B=0}.
}
\deqn{
\phi \;=\; \frac{ad - bc}{\sqrt{(a+c)(b+d)(a+b)(c+d)}}.
}
Undefined cases (zero denominator) are set to \eqn{\phi=0}.
}
