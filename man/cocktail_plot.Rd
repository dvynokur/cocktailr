% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cocktail_plot.R
\name{cocktail_plot}
\alias{cocktail_plot}
\title{Plot Cocktail dendrogram (PDF/PNG or current device)}
\usage{
cocktail_plot(
  x,
  file = NULL,
  phi_cut = NULL,
  label_clusters = FALSE,
  cex_species = 0.3,
  cex_clusters = 0.6,
  circle_inch = 0.1,
  page_size = 300,
  width_in = NULL,
  height_in = 10,
  alpha_fill = 0.18,
  alpha_border = 0.65,
  palette = "rainbow",
  png_res = 300
)
}
\arguments{
\item{x}{A Cocktail object (e.g. from \code{cocktail_cluster()}),
with components \code{Cluster.species}, \code{Cluster.merged},
and \code{Cluster.height}. If present, \code{x$species} is used
as the species names; otherwise \code{colnames(Cluster.species)}.}

\item{file}{Optional path to output. If it ends in:
\itemize{
\item \code{".pdf"} — create a (multi-page) PDF;
\item \code{".png"} — create one or more PNG files
(\code{*_page01.png}, \code{*_page02.png}, … if multiple pages);
\item anything else or \code{NULL} — draw only the first page
on the current graphics device.
}}

\item{phi_cut}{Optional numeric. If given, draw background bands for
parent clusters with \eqn{\phi \ge \mathrm{phi\_cut}}, and a dashed
horizontal line at this \eqn{\phi} level across each page.}

\item{label_clusters}{Logical/character. One of:
\itemize{
\item \code{FALSE} — no internal node labels;
\item \code{"all"} — label every internal node, placing the label
where the parent branch meets the node (intersection of the
parent’s vertical leg with the parent’s horizontal level;
for root nodes, at their own merge height), \emph{plus} an
additional set of labels at \eqn{\phi = 0} corresponding to
the \eqn{\phi_\mathrm{cut} = 0} clusters (i.e. the same labels
as \code{label_clusters = "phi_cut"} with \code{phi_cut = 0});
\item \code{"phi_cut"} — only label nodes whose vertical branch
crosses \code{phi_cut} (as in the dashed line).
}}

\item{cex_species}{Expansion factor for species (tip) labels on the x-axis.}

\item{cex_clusters}{Expansion factor for cluster-number labels.}

\item{circle_inch}{Circle radius (inches) for the white/black bubble
behind cluster labels.}

\item{page_size}{Integer, number of tips per page. Use
\code{ncol(x$Cluster.species)} to place all tips on a single page.}

\item{width_in}{Plot width in inches. If \code{NULL}, a width is chosen
automatically (capped at 150 inches) based on \code{page_size}.}

\item{height_in}{Plot height in inches (default 10).}

\item{alpha_fill, alpha_border}{Numeric alpha levels (0–1) for band fill
and border.}

\item{palette}{Color palette name for \code{grDevices::hcl.colors()}
(e.g., \code{"Set3"}, \code{"Dark2"}, \code{"Paired"}) or \code{"rainbow"}.
Default \code{"rainbow"}.}

\item{png_res}{Resolution in dpi for PNG output (default 300).}
}
\value{
Invisibly returns \code{NULL}. Produces a plot on the current
device or writes PDF/PNG files, depending on \code{file}.
}
\description{
Draw a dendrogram-style plot of a fitted Cocktail clustering.
Species (tips) are arranged left-to-right in the same order used
by the original algorithm, and the y-axis shows the \eqn{\phi}
height of each merge.

If \code{file} ends with \code{".pdf"} or \code{".png"}, the plot
is written to disk. Otherwise (including \code{file = NULL}),
the first page is drawn on the current graphics device (e.g.,
the Plots panel in RStudio).
}
