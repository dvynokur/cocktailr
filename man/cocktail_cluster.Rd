% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster.R
\name{cocktail_cluster}
\alias{cocktail_cluster}
\title{Cocktail clustering}
\usage{
cocktail_cluster(
  vegmatrix,
  binarize = TRUE,
  progress = TRUE,
  save_dir = NULL,
  save_csv = FALSE,
  save_rds = FALSE,
  rds_filename = "cocktail_cluster.rds",
  rds_compress = c("xz", "gzip", "bzip2", "none")
)
}
\arguments{
\item{vegmatrix}{numeric matrix or data.frame, \strong{plots in rows, species in columns}.
If you currently have species in rows, call \code{t()} before passing here.}

\item{binarize}{logical; if TRUE (default) convert positive abundances to presence/absence.}

\item{progress}{logical; show a text progress bar (default TRUE).}

\item{save_dir}{optional directory; if provided and \code{save_csv} or \code{save_rds} are TRUE,
files will be written there (created if missing).}

\item{save_csv}{logical; write the four CSVs \code{Cluster.species.csv}, \code{Cluster.info.csv},
\code{Plot.cluster.csv}, \code{Cluster.merged.csv} (default FALSE).}

\item{save_rds}{logical; write one RDS bundle with the full returned list (default FALSE).}

\item{rds_filename}{filename for the RDS bundle (default \code{"cocktail_cluster.rds"}).}

\item{rds_compress}{one of \code{"xz"}, \code{"gzip"}, \code{"bzip2"}, \code{"none"} (case-insensitive).
If an invalid value is supplied, it silently falls back to \code{"none"} and warns.}
}
\value{
A list with elements described above; class \code{"cocktail"} is added.
}
\description{
Runs the Cocktail hierarchical agglomeration on a plots x species matrix,
returning the same set of objects as in the original code:
\itemize{
\item \code{Cluster.species}: (n-1) x n binary matrix; species membership per cluster
\item \code{Cluster.info}:   (n-1) x 2 matrix with columns \code{k} (size), \code{m} (min spp per plot)
\item \code{Plot.cluster}:    N x (n-1) binary matrix; plot assignment per cluster
\item \code{Cluster.merged}:  (n-1) x 2 matrix; negative = species id, positive = cluster id
\item \code{Cluster.height}:  length n-1 numeric; phi value at which each merge formed
\item \code{species}:         character vector of species (column names of the input)
\item \code{plots}:           character vector of plot IDs (row names of the input)
}
}
\details{
The algorithm computes the pairwise \emph{phi} coefficient on species,
merges the most similar pairs (handling ties), and for each new group
determines the \code{m} threshold (minimum species per plot) by comparing
observed vs. expected plot-frequency distributions (Bruelheide 2000).

Memory tips (large data): set a larger workspace and disable GUI graphics, e.g.
\preformatted{
  options(expressions = 5e5)
  options(device = "pdf")    # avoid GUI devices on Windows
}

\strong{Forgot to assign the result?} If you call \code{cocktail_cluster(x)} without
assignment, you can still retrieve the last returned value via \code{.Last.value}
provided you haven't run another command that changed it.
}
