% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/species_in_clusters.R
\name{species_in_clusters}
\alias{species_in_clusters}
\title{Species in Cocktail clusters or fuzzy groups}
\usage{
species_in_clusters(
  x,
  labels = NULL,
  min_phi = 0.2,
  top_k = NULL,
  sort_desc = TRUE
)
}
\arguments{
\item{x}{Either:
\itemize{
\item a Cocktail object (a list containing \code{Cluster.species}); or
\item a numeric matrix returned by \code{cocktail_fuzzy()} with species in
rownames and node labels like \code{"c_2127"} in colnames.
}}

\item{labels}{Character cluster labels such as \code{"c_2127"} or integer node IDs.
If \code{x} is a \eqn{\phi} matrix and \code{labels} is omitted, all columns are used.
If \code{x} is a Cocktail object, \code{labels} must be supplied.}

\item{min_phi}{Numeric threshold used only when \code{x} is a \eqn{\phi} matrix:
keep species with \eqn{\phi \ge} \code{min_phi}. Default is \code{0.20}.}

\item{top_k}{Optional integer used only when \code{x} is a \eqn{\phi} matrix:
after filtering by \code{min_phi}, keep the top \code{k} species by \eqn{\phi}
for each requested label. Default \code{NULL} keeps all that pass \code{min_phi}.}

\item{sort_desc}{Logical; when \code{x} is a \eqn{\phi} matrix, sort species by
\eqn{\phi} decreasing (default \code{TRUE}).}
}
\value{
\itemize{
\item If \code{x} is a Cocktail object: a named list of character vectors
(species names) for the requested labels.
\item If \code{x} is a \eqn{\phi} matrix: a named list of data frames
(one per label) with columns \code{species} and \code{phi}.
}
}
\description{
Return the diagnostic species set for selected Cocktail nodes.
Works with either a Cocktail object (membership is binary) or a
species-by-nodes \eqn{\phi} matrix produced by \code{cocktail_fuzzy()}.
}
\seealso{
\code{\link{cocktail_fuzzy}}
}
